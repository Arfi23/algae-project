{
  "model": "SpectralAttentionHybridSN",
  "version": "v4_improved",
  "novelties": [
    "Spectral Self-Attention",
    "Multi-Objective Loss (Focal+Dice+Boundary)"
  ],
  "improvements": [
    "Learning rate: 5e-6 \u2192 1e-4",
    "Tile size: 32 \u2192 64",
    "Boundary loss weight: 0.5 \u2192 0.1",
    "Data augmentation: flip + rotation",
    "Focal loss replacing CE",
    "Early stopping patience: 10 \u2192 15"
  ],
  "hyperparameters": {
    "learning_rate": 0.0001,
    "batch_size": 1,
    "accumulation_steps": 4,
    "tile_size": 64,
    "num_epochs": 50,
    "attention_reduction": 16,
    "loss_weights": {
      "focal": 1.0,
      "dice": 1.0,
      "boundary": 0.1
    },
    "focal_gamma": 2.0,
    "early_stopping_patience": 15
  },
  "test_results": {
    "pixel_accuracy": 0.3735538211975704,
    "mean_iou": 0.1272214666629831,
    "loss_total": 0.7837949568401485,
    "loss_focal": 0.13418548073922232,
    "loss_dice": 0.5477815750534529,
    "loss_boundary": 1.0182789945181083,
    "iou_per_class": [
      0.0,
      0.0,
      0.0,
      0.012063984759151936,
      0.0,
      0.0,
      0.36960041522979736
    ]
  },
  "training_history": {
    "train_loss": [
      1.6918002094406208,
      1.611941116894623,
      1.5874587172951355,
      1.5675449884654824,
      1.5494869633061321,
      1.5179261440720215,
      1.4553374949465976,
      1.416138798845421,
      1.3969153758318158,
      1.371612633606179,
      1.340690802479925,
      1.3214163498144156,
      1.3194311727613939,
      1.3169022232825915,
      1.3106472410670353,
      1.3084208424408075,
      1.3046007623990796,
      1.2854354825346026,
      1.2779643943549306,
      1.2752446052418271,
      1.2660830913201437,
      1.2645537733677121,
      1.260002720793272,
      1.254057935232842,
      1.2569285528752794,
      1.2505210845657948,
      1.2431130057049364,
      1.237312323965935,
      1.2398332764160058,
      1.2384571371611113,
      1.2425044742508276,
      1.2212098947795746,
      1.2270701695615223,
      1.2283484290076343,
      1.2199011570912517,
      1.216619565068533,
      1.2199583275382753,
      1.211925864239363,
      1.2120314849699403,
      1.206526386662973,
      1.20859843831305,
      1.2015106846028736,
      1.205712643567096,
      1.1988612359435213,
      1.1990605197201796,
      1.1949389006275257,
      1.1943004895580265,
      1.1827431441692824,
      1.1793310542967015,
      1.1830806156813665
    ],
    "val_loss": [
      1.4090274457084506,
      1.4068644489896924,
      1.4052899867296218,
      1.387887381017208,
      1.3450610340425844,
      1.3005192824100194,
      1.2536686510239776,
      1.2043230146169663,
      1.2256118786570274,
      1.150792334228754,
      1.1324109211564064,
      1.1200076229478184,
      1.058185906943522,
      1.060973018094113,
      1.140035341209487,
      1.1366649550826926,
      1.071280938386917,
      1.0784313906180232,
      1.0761001432020414,
      0.9597505552596167,
      1.0053425344197373,
      0.9785065928572103,
      1.0143660859449914,
      0.9360363372454518,
      0.9395808429310196,
      1.0243979472078775,
      1.017943380537786,
      0.9264940678289062,
      0.922100155330018,
      1.063068046283565,
      1.0227149377920126,
      1.0694455347367022,
      1.1083680097601916,
      0.9894141554832458,
      1.3228209810429499,
      1.0722685717438396,
      1.0459776181139444,
      0.9902826743690591,
      1.0253278294284092,
      1.0700027291712009,
      0.9128497872305544,
      1.184845914554439,
      1.0555507761867422,
      1.0274196043610573,
      1.1258633671622527,
      0.9902900430716967,
      1.2399337171135765,
      1.04435483158419,
      0.9378113587828059,
      1.0590377804872237
    ],
    "train_acc": [
      0.36197941225152513,
      0.4635905532269539,
      0.5292612886581363,
      0.5953597396243914,
      0.6800951073615625,
      0.7308352904592028,
      0.7440021096604796,
      0.7735218187793877,
      0.792688740269849,
      0.7952079890874271,
      0.7990477179045563,
      0.7929051876369924,
      0.7971145817980063,
      0.8009258250194596,
      0.8018084468854776,
      0.7980315158588157,
      0.7954384634524411,
      0.799401198250898,
      0.7947902003508475,
      0.7941779758437831,
      0.7957530998046793,
      0.7949531293261148,
      0.8017514756941259,
      0.8043844510944401,
      0.7978012572937689,
      0.7964645922966748,
      0.8066596301490679,
      0.8051157971834219,
      0.8009061872224407,
      0.8059509430566467,
      0.8018462118797449,
      0.8117330873789171,
      0.8082133899132072,
      0.8132954791417462,
      0.808685776041499,
      0.8150958982684425,
      0.8092267865593736,
      0.8067273913387818,
      0.8128597790078854,
      0.8187988099063405,
      0.8113802544324772,
      0.8107358757302939,
      0.8130099757850855,
      0.812727277827999,
      0.8110744658788959,
      0.8115470678071549,
      0.8164198310674695,
      0.8164001932704505,
      0.8182133445952141,
      0.8177416058668241
    ],
    "val_acc": [
      0.06703208184626326,
      0.0679425428193585,
      0.08117930445445702,
      0.04388052653211536,
      0.2630752204005445,
      0.03627171575738789,
      0.03917702878786258,
      0.2664737564725807,
      0.06396508182974475,
      0.18753610993160366,
      0.056811598709224795,
      0.059723907811211,
      0.32381180956304667,
      0.5053791044834129,
      0.03575109143573962,
      0.043075783972971834,
      0.197563035090157,
      0.04452571979373248,
      0.03544481897179125,
      0.1206993350817034,
      0.08479899412038489,
      0.2606707094891021,
      0.045769465840223324,
      0.47603622021689757,
      0.29511664491730544,
      0.03882003480545576,
      0.15895132774748844,
      0.41479980061196187,
      0.5795926537362421,
      0.037069267909700145,
      0.03663007008703307,
      0.0389191458185355,
      0.034584107840555635,
      0.0623040978517202,
      0.03455845557834676,
      0.055711855134679224,
      0.03457905512224177,
      0.041976817739705324,
      0.09294669673681846,
      0.03474501748532039,
      0.6806522670672565,
      0.034584885181834696,
      0.05256828700217363,
      0.17865809518349623,
      0.03461345247384003,
      0.27603175050454304,
      0.034578860786922,
      0.03628706824764927,
      0.3845662775749672,
      0.03526661348356749
    ],
    "val_miou": [
      0.019187881797552108,
      0.023562220623716712,
      0.0413801334798336,
      0.029698784463107586,
      0.09960907511413097,
      0.010684529968159495,
      0.013025020507484442,
      0.1037896447815001,
      0.019957916573275725,
      0.06538685015402734,
      0.017407033243216574,
      0.0228879414498806,
      0.12563740877279392,
      0.1710518468171358,
      0.009104067627959012,
      0.014893618877977133,
      0.06405524412548402,
      0.01252205664786743,
      0.008991411865281407,
      0.039947203687916044,
      0.02733623686071951,
      0.08388634701259434,
      0.013460208872857038,
      0.17218446917831898,
      0.10350366204511374,
      0.010891897953115404,
      0.05259485365240835,
      0.13488864991813898,
      0.18999849539250135,
      0.014667642788178151,
      0.009545620661810972,
      0.010320786223246614,
      0.011531352687294808,
      0.020525875501334667,
      0.008646506816148758,
      0.022205882240086794,
      0.011526519229505539,
      0.019857169982666772,
      0.03009938976867943,
      0.008709557754855268,
      0.22761139716021717,
      0.008649713097383938,
      0.021446453252186377,
      0.058328976589109516,
      0.008660813071401208,
      0.0908101461827755,
      0.011526286602020264,
      0.012408992849183656,
      0.15989551392461485,
      0.011888371973327594
    ],
    "train_loss_focal": [
      0.19989124293672056,
      0.17260393228624907,
      0.15719342519163557,
      0.14675570979443514,
      0.13997854277324934,
      0.13427934156302912,
      0.13868637929137623,
      0.13651323056289585,
      0.1396594524792453,
      0.14755382283475113,
      0.16615341378451026,
      0.17534068801879246,
      0.18739194442407564,
      0.19349950868716803,
      0.19472330513595287,
      0.20258200810028668,
      0.21902267545112292,
      0.24337412042802037,
      0.2725561698672133,
      0.28134216482371266,
      0.2781008476632841,
      0.27840339318587093,
      0.27640833081622823,
      0.27215819360669186,
      0.276044823693035,
      0.2712476237600224,
      0.265944058885304,
      0.2609064439402137,
      0.26536665093174716,
      0.2645051394079376,
      0.27051657787444544,
      0.2503864054886173,
      0.2568093543714809,
      0.2599982716099486,
      0.25295947966819665,
      0.25168265471021056,
      0.25587415526886614,
      0.24869323441576233,
      0.2496952084011212,
      0.2450746914029078,
      0.24816010877098818,
      0.24211149795146317,
      0.24787918582660992,
      0.24204969863437698,
      0.24381695455269456,
      0.24226077944074287,
      0.24380099709845987,
      0.2347643451084979,
      0.2332016562091178,
      0.23861941126791902
    ],
    "train_loss_dice": [
      0.941561837623392,
      0.9315551837311623,
      0.9224832932128074,
      0.9130072798149048,
      0.9017264196515005,
      0.8758648037516511,
      0.8088691166829212,
      0.7718435700020093,
      0.7494739246384167,
      0.7162768103315273,
      0.6667553865586537,
      0.6382936620980166,
      0.6242572316174781,
      0.6156207180070468,
      0.608141937282648,
      0.5980568351291775,
      0.5777960880182472,
      0.5342793648635324,
      0.49762622611221696,
      0.48612044252312425,
      0.4802002452968842,
      0.4783683808450264,
      0.4758123901610491,
      0.47411774040765503,
      0.47310172601480477,
      0.4714914630835055,
      0.4693869472101518,
      0.4686238783444306,
      0.46668462290798524,
      0.46617000030510014,
      0.4642058971774397,
      0.46304149121065763,
      0.4624788163516668,
      0.46056815964137177,
      0.4591596792725956,
      0.45715491155560095,
      0.45630217335197365,
      0.4554506303534473,
      0.45455427888364724,
      0.4536697001781829,
      0.4526563292690562,
      0.45161718441332244,
      0.45005146064903273,
      0.4490295379506935,
      0.44746156390423975,
      0.4448961219642624,
      0.4427174948653242,
      0.4401968014768158,
      0.4383473997075118,
      0.43667920649800174
    ],
    "train_loss_boundary": [
      5.503471188812699,
      5.077819908390644,
      5.077819911505888,
      5.077819895699912,
      5.077819903613691,
      5.077819909138188,
      5.0778198964680765,
      5.077819896964822,
      5.0778198897564595,
      5.077819904561326,
      5.077819905523388,
      5.0778199006202485,
      5.077819894774398,
      5.077819901312162,
      5.077819889511202,
      5.07781990193044,
      5.077819904144254,
      5.077819890189535,
      5.077819895001881,
      5.077819903382515,
      5.0778199044074395,
      5.077819899332562,
      5.077819895730997,
      5.077819902185892,
      5.077819910278488,
      5.077819903506894,
      5.077819909699566,
      5.077819901332744,
      5.077819899519342,
      5.077819907110883,
      5.077819915089603,
      5.077819899849007,
      5.077819896002761,
      5.077819898643457,
      5.077819884893638,
      5.077819897001794,
      5.077819891650228,
      5.077819911942312,
      5.077819893695961,
      5.077819895921509,
      5.077819898756064,
      5.077819914827995,
      5.077819893549498,
      5.077819898426477,
      5.077819909715301,
      5.07781988620383,
      5.077819896545635,
      5.077819899274085,
      5.077819900005047,
      5.077819900574428
    ],
    "val_loss_focal": [
      0.1406060557667687,
      0.1416840922672535,
      0.13936593496158772,
      0.12614951596876237,
      0.09945582763028285,
      0.09809805179292808,
      0.09991273801835249,
      0.0853196774756713,
      0.11721774866705884,
      0.09356617052617426,
      0.11082902641205812,
      0.09193673724222376,
      0.058412207384459465,
      0.06366660055021288,
      0.1245919275776409,
      0.10651846101955435,
      0.11444720649603943,
      0.11041173722740041,
      0.16419406128074338,
      0.09615649693745115,
      0.12499242712216181,
      0.08896071288854727,
      0.12633194409643297,
      0.06798724265511522,
      0.04981888652521021,
      0.10624605840440579,
      0.14282660995473503,
      0.06961150081835968,
      0.05466690632903297,
      0.18061251017984603,
      0.14421621470794255,
      0.1999696795803456,
      0.19695322734431642,
      0.10264666968860811,
      0.4270037456217376,
      0.1083796753373349,
      0.16993220604760165,
      0.10965632831645639,
      0.15188695540372776,
      0.16512715172216302,
      0.04617969949467058,
      0.29231623864830186,
      0.0935828542067327,
      0.14157435962797116,
      0.21486676244289615,
      0.13204101715670527,
      0.3523014291070042,
      0.15414660699671018,
      0.08042308803919038,
      0.1460682299256297
    ],
    "val_loss_dice": [
      0.943076934900723,
      0.9398359022250301,
      0.9405795979264535,
      0.936393411418325,
      0.9202607522669591,
      0.8770767758551397,
      0.8284114585895287,
      0.7936588848499875,
      0.7830496745282098,
      0.7318817092791984,
      0.6962374397406452,
      0.7027264311125404,
      0.6744292463911207,
      0.6719619646276298,
      0.6900989589330397,
      0.7048020402067586,
      0.6314892776310443,
      0.6426751993596553,
      0.5865616275291694,
      0.5382496038157689,
      0.5550056535946696,
      0.5642014260354795,
      0.5626896878214259,
      0.542704640250457,
      0.5644175010292154,
      0.5928074346561181,
      0.5497723157860731,
      0.531538113677188,
      0.5420887940024075,
      0.557111081010417,
      0.5531542689784577,
      0.5441314014165025,
      0.5860703271078436,
      0.561423031593624,
      0.5704727809287999,
      0.638544443759479,
      0.5507009572104404,
      0.5552818913993083,
      0.5480964193610769,
      0.5795311250184711,
      0.5413256333454659,
      0.5671852226712202,
      0.636623466955988,
      0.5605007905709116,
      0.5856521484883208,
      0.5329045725496192,
      0.5622878345219713,
      0.5648637716707431,
      0.532043817443283,
      0.5876250964246298
    ],
    "val_loss_boundary": [
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994,
      3.2534444841085994
    ]
  }
}